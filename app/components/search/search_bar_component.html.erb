<div class="container search-bar-container" data-controller="search-bar" data-search-bar-placeholders-value="<%= placeholders.to_json %>" data-search-bar-option-labels-value="<%= option_labels.to_json %>">
  <%= form_tag("/search", method: "get", id: "search-box", class: "d-flex flex-column flex-sm-row gap-3 h-100 w-100 search-bar-form") do %>
    <div class="d-flex justify-content-center search-bar">
      <div class="select-wrapper" data-search-bar-target="selectWrapper">
        <button type="button" class="select-button" data-search-bar-target="selectButton" data-action="click->search-bar#toggleDropdown">
          <span data-search-bar-target="selectedOption"><%= option_labels[resource || resource_options.first] %></span>
          <%= image_tag "svgs/dropdown-arrow.svg", class: "select-arrow", alt: "Dropdown arrow" %>
        </button>
        <div class="select-dropdown" data-search-bar-target="dropdown">
          <% resource_options.each do |option| %>
            <div class="select-option <%= "active" if option == (resource || resource_options.first) %>" data-value="<%= option %>" data-action="click->search-bar#selectOption">
              <%= option_labels[option] %>
            </div>
          <% end %>
        </div>
        <%= hidden_field_tag :resource, resource || resource_options.first, data: { search_bar_target: "hiddenSelect" } %>
      </div>
      <%= text_field_tag :q, query, autocomplete: "off", class: "search-bar-input h-100", data: { search_bar_target: "input" } %>
      <button class="search-bar-button rounded-end" type="submit" name="button" value="Submit" aria-label="Search">
        <%= image_tag "svgs/search-icon.svg", alt: "Search Icon" %>
      </button>
    </div>
    <div class="sorting-container" data-controller="search-sorting" data-search-sorting-selected-sort-value="<%= sort_by %>" data-search-sorting-sort-direction-value="<%= sort_direction %>" data-search-sorting-all-options-value='<%= all_sorting_options.to_json %>' data-search-sorting-current-resource-value="<%= resource || resource_options.first %>" data-action="search-bar:resource-changed@window->search-sorting#updateOptionsForResource">
      <div class="d-flex sorting-buttons justify-content-center h-100">
        <button type="button" data-search-sorting-target="sorting" data-action="click->search-sorting#toggleOptions">
          <span data-search-sorting-target="sortingText"><%= sort_by %></span>
          <%= image_tag "svgs/dropdown-arrow.svg", class: "select-arrow black-arrow", alt: "Dropdown arrow" %>
        </button>
        <button type="button" data-search-sorting-target="sortingDirection" data-action="click->search-sorting#toggleSortingDirection">
          <%= image_tag "svgs/sort-asc.svg", class: "sort-arrow", alt: "Sort ascending", data: { search_sorting_target: "ascIcon" } %>
          <%= image_tag "svgs/sort-desc.svg", class: "sort-arrow d-none", alt: "Sort descending", data: { search_sorting_target: "descIcon" } %>
        </button>
      </div>
      <ul class="sorting-options" data-search-sorting-target="optionsList">
      </ul>
      <%= hidden_field_tag :sort_by, sort_by, data: { search_sorting_target: "hiddenSortBy" } %>
      <%= hidden_field_tag :sort_direction, sort_direction, data: { search_sorting_target: "hiddenSortDirection" } %>
    </div>
  <% end %>
</div>
